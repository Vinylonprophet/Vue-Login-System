# Excel导入功能使用说明

## 功能概述

Excel导入功能支持导入专家评分数据，自动为每个专家创建独立的IP记录。

## Excel文件格式要求

### 必需列

1. **index**：指标名称列
   - 包含系统中定义的32个三级指标名称
   - 指标名称必须与系统中的完全匹配

2. **expert_专家1 到 expert_专家10**：专家评分列
   - 列名格式：`expert_专家N`（N为专家编号1-10）
   - 包含该专家对各指标的评分数据
   - 评分范围建议：0-100

3. **group_name**：组别名称列
   - 指定IP所属的组别
   - 所有行应该使用相同的组别名称

### 示例格式

```csv
index,expert_专家1,expert_专家2,expert_专家3,group_name
历史渊源,85.5,87.2,84.8,传统体育
文化象征性,87.3,86.9,88.1,传统体育
民族记忆,84.2,85.8,84.6,传统体育
...
```

## 系统支持的32个三级指标

### 文化价值类
1. 历史渊源
2. 文化象征性
3. 民族记忆
4. 独特性
5. 跨民族文化联系
6. 跨民族文化认同
7. 传播渠道
8. 媒体关注度
9. 跨平台传播
10. 社会关注度
11. 民众参与度
12. 政府支持度

### 市场潜力类
13. 消费者需求
14. 市场成熟度
15. 市场增长潜力
16. 竞争者数量
17. 竞争者创新能力
18. 竞争壁垒
19. 商业模式多样性
20. 品牌价值
21. 合作机会

### 社会效益类
22. 民族文化传承
23. 民族文化融合
24. 民族自豪感
25. 教育意义
26. 社会和谐

### 创新性类
27. 规则创新
28. 场地设备创新
29. 商业化创新
30. 跨界合作创新
31. 媒体传播创新
32. 社交平台创新

## 导入结果

导入成功后，系统将：

1. **创建IP记录**：为每个专家创建一个独立的IP记录
2. **命名规则**：IP名称 = 组别名称 + 专家名称
   - 例如：`传统体育专家1`、`传统体育专家2`
3. **评分映射**：将专家评分按指标顺序映射到系统的32个指标位置
4. **错误处理**：报告导入过程中的任何错误

## 使用步骤

1. 准备Excel文件（.xlsx或.xls格式）
2. 确保文件包含所有必需列和完整的指标数据
3. 在IP管理页面点击"Excel导入"按钮
4. 选择准备好的Excel文件
5. 等待导入完成，查看导入结果日志

## 注意事项

1. **指标完整性**：Excel文件中必须包含所有32个系统指标
2. **数据格式**：评分必须为数字格式
3. **指标匹配**：指标名称必须与系统定义完全一致
4. **文件大小**：支持最大10MB的文件
5. **重复处理**：如果存在同名IP，将更新现有记录

## 错误排查

### 常见错误及解决方案

1. **"未找到指标数据"**
   - 检查index列是否存在
   - 确认指标名称格式正确

2. **"未找到专家评分数据"**
   - 检查expert_专家N列是否存在
   - 确认列名格式正确

3. **"未找到组别信息"**
   - 检查group_name列是否存在
   - 确认组别名称不为空

4. **"指标在系统中未找到"**
   - 对照系统指标列表检查指标名称
   - 确保指标名称完全匹配（包括标点符号）

## 测试文件

项目中提供了`test-expert-scores.csv`测试文件，包含完整的示例数据格式，可用于测试导入功能。 